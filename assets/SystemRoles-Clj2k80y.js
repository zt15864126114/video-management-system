import{f as d,T as P,o as x,b as l,w as t,r as o,ak as z,j as G,a as J,e as m,k,I as L,a9 as O,i as _,ag as Q,t as W,ac as X,a3 as y}from"./vendor-B1sSQAux.js";import{_ as Y}from"./main-Cako4ZLr.js";const Z={class:"system-roles"},ee={class:"card-header"},le={class:"card-header"},te={class:"title"},ae={__name:"SystemRoles",setup(oe){const R=d(!1),w=d([{id:1,name:"超级管理员",description:"系统最高权限",permissions:[1,2,3,4,5]},{id:2,name:"操作员",description:"日常操作权限",permissions:[1,2,3]}]),T=[{id:1,name:"系统管理",children:[{id:2,name:"用户管理"},{id:3,name:"角色管理"}]},{id:4,name:"业务管理",children:[{id:5,name:"车辆管理"},{id:6,name:"门禁管理"}]}],s=d(null),u=d(null),r=d(!1),p=d("add"),f=d(null),i=d({name:"",description:""}),B={name:[{required:!0,message:"请输入角色名称",trigger:"blur"}]},S=a=>{s.value=a,u.value&&u.value.setCheckedKeys(a.permissions||[])},D=()=>{p.value="add",i.value={name:"",description:""},r.value=!0,s.value=null},K=a=>{p.value="edit",i.value={...a},r.value=!0,s.value=a},$=a=>{X.confirm(`确定要删除角色 ${a.name} 吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{var e;y.success("删除成功"),((e=s.value)==null?void 0:e.id)===a.id&&(s.value=null)})},E=async()=>{f.value&&await f.value.validate(a=>{a&&(y.success(p.value==="add"?"添加成功":"更新成功"),r.value=!1)})},F=()=>{if(!u.value)return;const a=u.value.getCheckedKeys(),e=u.value.getHalfCheckedKeys();[...a,...e],y.success("权限保存成功")};return(a,e)=>{const v=o("el-icon"),c=o("el-button"),g=o("el-table-column"),N=o("el-button-group"),U=o("el-table"),b=o("el-card"),h=o("el-col"),I=o("el-tree"),M=o("el-row"),C=o("el-input"),V=o("el-form-item"),j=o("el-form"),q=o("el-dialog"),A=z("loading");return x(),P("div",Z,[l(M,{gutter:20},{default:t(()=>[l(h,{span:8},{default:t(()=>[l(b,null,{header:t(()=>[_("div",ee,[e[5]||(e[5]=_("span",{class:"title"},"角色列表",-1)),l(c,{type:"primary",onClick:D},{default:t(()=>[l(v,null,{default:t(()=>[l(k(Q))]),_:1}),e[4]||(e[4]=m("新增角色 "))]),_:1})])]),default:t(()=>[G((x(),J(U,{data:w.value,style:{width:"100%"},onRowClick:S,"highlight-current-row":""},{default:t(()=>[l(g,{prop:"name",label:"角色名称"}),l(g,{label:"操作",width:"120"},{default:t(({row:n})=>[l(N,null,{default:t(()=>[l(c,{type:"primary",link:"",onClick:H=>K(n)},{default:t(()=>[l(v,null,{default:t(()=>[l(k(L))]),_:1}),e[6]||(e[6]=m("编辑 "))]),_:2},1032,["onClick"]),l(c,{type:"danger",link:"",onClick:H=>$(n)},{default:t(()=>[l(v,null,{default:t(()=>[l(k(O))]),_:1}),e[7]||(e[7]=m("删除 "))]),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[A,R.value]])]),_:1})]),_:1}),l(h,{span:16},{default:t(()=>[l(b,null,{header:t(()=>[_("div",le,[_("span",te,"权限设置"+W(s.value?` - ${s.value.name}`:""),1),l(c,{type:"primary",onClick:F},{default:t(()=>e[8]||(e[8]=[m("保存")])),_:1})])]),default:t(()=>{var n;return[l(I,{ref_key:"permissionTree",ref:u,data:T,"show-checkbox":"","node-key":"id","default-checked-keys":((n=s.value)==null?void 0:n.permissions)||[],props:{label:"name"}},null,8,["default-checked-keys"])]}),_:1})]),_:1})]),_:1}),l(q,{title:p.value==="add"?"新增角色":"编辑角色",modelValue:r.value,"onUpdate:modelValue":e[3]||(e[3]=n=>r.value=n),width:"500px"},{footer:t(()=>[l(c,{onClick:e[2]||(e[2]=n=>r.value=!1)},{default:t(()=>e[9]||(e[9]=[m("取消")])),_:1}),l(c,{type:"primary",onClick:E},{default:t(()=>e[10]||(e[10]=[m("确定")])),_:1})]),default:t(()=>[l(j,{ref_key:"roleFormRef",ref:f,model:i.value,rules:B,"label-width":"80px"},{default:t(()=>[l(V,{label:"角色名称",prop:"name"},{default:t(()=>[l(C,{modelValue:i.value.name,"onUpdate:modelValue":e[0]||(e[0]=n=>i.value.name=n)},null,8,["modelValue"])]),_:1}),l(V,{label:"描述",prop:"description"},{default:t(()=>[l(C,{modelValue:i.value.description,"onUpdate:modelValue":e[1]||(e[1]=n=>i.value.description=n),type:"textarea",rows:3},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}},de=Y(ae,[["__scopeId","data-v-cd8c9d63"]]);export{de as default};
