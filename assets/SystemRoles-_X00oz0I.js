import{_ as O,r as d,c as X,b as x,d as l,w as t,e as n,a0 as j,a1 as z,k as G,n as m,g as k,O as J,P as L,f as _,X as Q,t as W,S as Y,I as y}from"./index-DE67zCuG.js";const Z={class:"system-roles"},ee={class:"card-header"},le={class:"card-header"},te={class:"title"},ae={__name:"SystemRoles",setup(ne){const R=d(!1),w=d([{id:1,name:"超级管理员",description:"系统最高权限",permissions:[1,2,3,4,5]},{id:2,name:"操作员",description:"日常操作权限",permissions:[1,2,3]}]),B=[{id:1,name:"系统管理",children:[{id:2,name:"用户管理"},{id:3,name:"角色管理"}]},{id:4,name:"业务管理",children:[{id:5,name:"车辆管理"},{id:6,name:"门禁管理"}]}],s=d(null),u=d(null),r=d(!1),p=d("add"),f=d(null),i=d({name:"",description:""}),S={name:[{required:!0,message:"请输入角色名称",trigger:"blur"}]},T=a=>{s.value=a,u.value&&u.value.setCheckedKeys(a.permissions||[])},D=()=>{p.value="add",i.value={name:"",description:""},r.value=!0,s.value=null},K=a=>{p.value="edit",i.value={...a},r.value=!0,s.value=a},$=a=>{Y.confirm(`确定要删除角色 ${a.name} 吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{var e;y.success("删除成功"),((e=s.value)==null?void 0:e.id)===a.id&&(s.value=null)})},E=async()=>{f.value&&await f.value.validate(a=>{a&&(y.success(p.value==="add"?"添加成功":"更新成功"),r.value=!1)})},F=()=>{if(!u.value)return;const a=u.value.getCheckedKeys(),e=u.value.getHalfCheckedKeys();[...a,...e],y.success("权限保存成功")};return(a,e)=>{const v=n("el-icon"),c=n("el-button"),g=n("el-table-column"),N=n("el-button-group"),U=n("el-table"),b=n("el-card"),h=n("el-col"),I=n("el-tree"),M=n("el-row"),C=n("el-input"),V=n("el-form-item"),P=n("el-form"),q=n("el-dialog"),A=j("loading");return x(),X("div",Z,[l(M,{gutter:20},{default:t(()=>[l(h,{span:8},{default:t(()=>[l(b,null,{header:t(()=>[_("div",ee,[e[5]||(e[5]=_("span",{class:"title"},"角色列表",-1)),l(c,{type:"primary",onClick:D},{default:t(()=>[l(v,null,{default:t(()=>[l(k(Q))]),_:1}),e[4]||(e[4]=m("新增角色 "))]),_:1})])]),default:t(()=>[z((x(),G(U,{data:w.value,style:{width:"100%"},onRowClick:T,"highlight-current-row":""},{default:t(()=>[l(g,{prop:"name",label:"角色名称"}),l(g,{label:"操作",width:"120"},{default:t(({row:o})=>[l(N,null,{default:t(()=>[l(c,{type:"primary",link:"",onClick:H=>K(o)},{default:t(()=>[l(v,null,{default:t(()=>[l(k(J))]),_:1}),e[6]||(e[6]=m("编辑 "))]),_:2},1032,["onClick"]),l(c,{type:"danger",link:"",onClick:H=>$(o)},{default:t(()=>[l(v,null,{default:t(()=>[l(k(L))]),_:1}),e[7]||(e[7]=m("删除 "))]),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[A,R.value]])]),_:1})]),_:1}),l(h,{span:16},{default:t(()=>[l(b,null,{header:t(()=>[_("div",le,[_("span",te,"权限设置"+W(s.value?` - ${s.value.name}`:""),1),l(c,{type:"primary",onClick:F},{default:t(()=>e[8]||(e[8]=[m("保存")])),_:1})])]),default:t(()=>{var o;return[l(I,{ref_key:"permissionTree",ref:u,data:B,"show-checkbox":"","node-key":"id","default-checked-keys":((o=s.value)==null?void 0:o.permissions)||[],props:{label:"name"}},null,8,["default-checked-keys"])]}),_:1})]),_:1})]),_:1}),l(q,{title:p.value==="add"?"新增角色":"编辑角色",modelValue:r.value,"onUpdate:modelValue":e[3]||(e[3]=o=>r.value=o),width:"500px"},{footer:t(()=>[l(c,{onClick:e[2]||(e[2]=o=>r.value=!1)},{default:t(()=>e[9]||(e[9]=[m("取消")])),_:1}),l(c,{type:"primary",onClick:E},{default:t(()=>e[10]||(e[10]=[m("确定")])),_:1})]),default:t(()=>[l(P,{ref_key:"roleFormRef",ref:f,model:i.value,rules:S,"label-width":"80px"},{default:t(()=>[l(V,{label:"角色名称",prop:"name"},{default:t(()=>[l(C,{modelValue:i.value.name,"onUpdate:modelValue":e[0]||(e[0]=o=>i.value.name=o)},null,8,["modelValue"])]),_:1}),l(V,{label:"描述",prop:"description"},{default:t(()=>[l(C,{modelValue:i.value.description,"onUpdate:modelValue":e[1]||(e[1]=o=>i.value.description=o),type:"textarea",rows:3},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}},se=O(ae,[["__scopeId","data-v-cd8c9d63"]]);export{se as default};
