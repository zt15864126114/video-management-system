import{_ as O,r as d,c as P,b as x,d as l,w as t,f as a,$ as j,a0 as z,i as G,l as m,h as y,K as J,L as Q,e as _,U as W,t as X,O as Y,E as k}from"./index-vINHRGGD.js";const Z={class:"system-roles"},ee={class:"card-header"},le={class:"card-header"},te={class:"title"},oe={__name:"SystemRoles",setup(ae){const R=d(!1),w=d([{id:1,name:"超级管理员",description:"系统最高权限",permissions:[1,2,3,4,5]},{id:2,name:"操作员",description:"日常操作权限",permissions:[1,2,3]}]),B=[{id:1,name:"系统管理",children:[{id:2,name:"用户管理"},{id:3,name:"角色管理"}]},{id:4,name:"业务管理",children:[{id:5,name:"车辆管理"},{id:6,name:"门禁管理"}]}],s=d(null),u=d(null),r=d(!1),p=d("add"),f=d(null),i=d({name:"",description:""}),T={name:[{required:!0,message:"请输入角色名称",trigger:"blur"}]},K=o=>{s.value=o,u.value&&u.value.setCheckedKeys(o.permissions||[])},S=()=>{p.value="add",i.value={name:"",description:""},r.value=!0,s.value=null},$=o=>{p.value="edit",i.value={...o},r.value=!0,s.value=o},D=o=>{Y.confirm(`确定要删除角色 ${o.name} 吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{var e;k.success("删除成功"),((e=s.value)==null?void 0:e.id)===o.id&&(s.value=null)})},E=async()=>{f.value&&await f.value.validate(o=>{o&&(k.success(p.value==="add"?"添加成功":"更新成功"),r.value=!1)})},U=()=>{if(!u.value)return;const o=u.value.getCheckedKeys(),e=u.value.getHalfCheckedKeys();[...o,...e],k.success("权限保存成功")};return(o,e)=>{const v=a("el-icon"),c=a("el-button"),g=a("el-table-column"),F=a("el-button-group"),N=a("el-table"),b=a("el-card"),h=a("el-col"),M=a("el-tree"),q=a("el-row"),C=a("el-input"),V=a("el-form-item"),A=a("el-form"),H=a("el-dialog"),I=j("loading");return x(),P("div",Z,[l(q,{gutter:20},{default:t(()=>[l(h,{span:8},{default:t(()=>[l(b,null,{header:t(()=>[_("div",ee,[e[5]||(e[5]=_("span",{class:"title"},"角色列表",-1)),l(c,{type:"primary",onClick:S},{default:t(()=>[l(v,null,{default:t(()=>[l(y(W))]),_:1}),e[4]||(e[4]=m("新增角色 "))]),_:1})])]),default:t(()=>[z((x(),G(N,{data:w.value,style:{width:"100%"},onRowClick:K,"highlight-current-row":""},{default:t(()=>[l(g,{prop:"name",label:"角色名称"}),l(g,{label:"操作",width:"120"},{default:t(({row:n})=>[l(F,null,{default:t(()=>[l(c,{type:"primary",link:"",onClick:L=>$(n)},{default:t(()=>[l(v,null,{default:t(()=>[l(y(J))]),_:1}),e[6]||(e[6]=m("编辑 "))]),_:2},1032,["onClick"]),l(c,{type:"danger",link:"",onClick:L=>D(n)},{default:t(()=>[l(v,null,{default:t(()=>[l(y(Q))]),_:1}),e[7]||(e[7]=m("删除 "))]),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[I,R.value]])]),_:1})]),_:1}),l(h,{span:16},{default:t(()=>[l(b,null,{header:t(()=>[_("div",le,[_("span",te,"权限设置"+X(s.value?` - ${s.value.name}`:""),1),l(c,{type:"primary",onClick:U},{default:t(()=>e[8]||(e[8]=[m("保存")])),_:1})])]),default:t(()=>{var n;return[l(M,{ref_key:"permissionTree",ref:u,data:B,"show-checkbox":"","node-key":"id","default-checked-keys":((n=s.value)==null?void 0:n.permissions)||[],props:{label:"name"}},null,8,["default-checked-keys"])]}),_:1})]),_:1})]),_:1}),l(H,{title:p.value==="add"?"新增角色":"编辑角色",modelValue:r.value,"onUpdate:modelValue":e[3]||(e[3]=n=>r.value=n),width:"500px"},{footer:t(()=>[l(c,{onClick:e[2]||(e[2]=n=>r.value=!1)},{default:t(()=>e[9]||(e[9]=[m("取消")])),_:1}),l(c,{type:"primary",onClick:E},{default:t(()=>e[10]||(e[10]=[m("确定")])),_:1})]),default:t(()=>[l(A,{ref_key:"roleFormRef",ref:f,model:i.value,rules:T,"label-width":"80px"},{default:t(()=>[l(V,{label:"角色名称",prop:"name"},{default:t(()=>[l(C,{modelValue:i.value.name,"onUpdate:modelValue":e[0]||(e[0]=n=>i.value.name=n)},null,8,["modelValue"])]),_:1}),l(V,{label:"描述",prop:"description"},{default:t(()=>[l(C,{modelValue:i.value.description,"onUpdate:modelValue":e[1]||(e[1]=n=>i.value.description=n),type:"textarea",rows:3},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}},se=O(oe,[["__scopeId","data-v-cd8c9d63"]]);export{se as default};
