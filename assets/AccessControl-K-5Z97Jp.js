import{_ as te,r as v,m as ue,c as S,b as y,d as l,w as o,f as n,l as t,t as I,F as B,g as q,i as H,e as $,h as R,W as de,X as ne,Y as ie,E as L}from"./index-Yu6Nrlez.js";const re={class:"access-control"},me={class:"card-header"},se={class:"header-left"},pe={__name:"AccessControl",setup(fe){const g=v([{id:1,name:"教学楼正门",location:"教学区",type:"人脸识别",timing:{type:"open",time:"07:30"},openTime:"07:00-22:00",allowedGroups:["教师","学生","工作人员"]},{id:2,name:"图书馆入口",location:"教学区",type:"刷卡门禁",openTime:"08:00-22:30",allowedGroups:["教师","学生"]},{id:3,name:"实验楼大门",location:"实验区",type:"人脸识别",timing:{type:"close",time:"22:00"},openTime:"08:00-22:00",allowedGroups:["教师","研究生","实验室人员"]},{id:4,name:"宿舍楼A座",location:"生活区",type:"人脸识别",openTime:"06:00-23:00",allowedGroups:["学生","宿管人员"]},{id:5,name:"宿舍楼B座",location:"生活区",type:"人脸识别",openTime:"06:00-23:00",allowedGroups:["学生","宿管人员"]},{id:6,name:"食堂主入口",location:"生活区",type:"刷卡门禁",openTime:"06:30-20:00",allowedGroups:["教师","学生","工作人员"]},{id:7,name:"体育馆入口",location:"运动区",type:"密码门禁",timing:{type:"close",time:"22:00"},openTime:"09:00-22:00",allowedGroups:["教师","学生"]},{id:8,name:"游泳馆入口",location:"运动区",type:"刷卡门禁",timing:{type:"close",time:"21:30"},openTime:"09:00-21:30",allowedGroups:["教师","学生","会员"]},{id:9,name:"行政楼入口",location:"办公区",type:"人脸识别",openTime:"08:30-17:30",allowedGroups:["教师","行政人员"]},{id:10,name:"艺术楼入口",location:"教学区",type:"刷卡门禁",openTime:"08:00-22:00",allowedGroups:["教师","学生","艺术系人员"]}]),E=v(""),F=v(""),W=ue(()=>g.value.filter(u=>{const e=u.name.toLowerCase().includes(E.value.toLowerCase())||u.location.toLowerCase().includes(E.value.toLowerCase()),_=!F.value||u.type===F.value;return e&&_})),w=v(!1),T=v(!1),C=v(!1),i=v({doorId:"",type:"open",time:null,repeat:[]}),b=v({doorId:"",groups:[]}),X=[{key:"教师",label:"教师"},{key:"学生",label:"学生"},{key:"工作人员",label:"工作人员"},{key:"访客",label:"访客"},{key:"研究生",label:"研究生"},{key:"行政人员",label:"行政人员"},{key:"宿管人员",label:"宿管人员"},{key:"实验室人员",label:"实验室人员"}],N=v(null),d=v({name:"",location:"",type:"",startTime:null,endTime:null,allowedGroups:[]}),Y={name:[{required:!0,message:"请输入门禁名称",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],location:[{required:!0,message:"请选择所在位置",trigger:"change"}],type:[{required:!0,message:"请选择门禁类型",trigger:"change"}],allowedGroups:[{type:"array",required:!0,message:"请选择允许通行的人员",trigger:"change"}]},j=u=>{i.value.doorId=u.id,u.timing&&(i.value={...u.timing,doorId:u.id}),w.value=!0},J=u=>{b.value.doorId=u.id,b.value.groups=u.allowedGroups.map(e=>e),T.value=!0},K=()=>{if(!i.value.time){L.warning("请选择执行时间");return}const u=g.value.find(e=>e.id===i.value.doorId);u&&(u.timing={type:i.value.type,time:i.value.time.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}),repeat:i.value.repeat}),w.value=!1,L.success("定时设置成功")},Z=()=>{const u=g.value.find(e=>e.id===b.value.doorId);u&&(u.allowedGroups=b.value.groups),T.value=!1,L.success("权限设置成功")},G=v(!1),s=v({doorId:"",workdayStart:null,workdayEnd:null,holidayStart:null,holidayEnd:null}),c=u=>{s.value.doorId=u.id,G.value=!0},h=()=>{const u=g.value.find(e=>e.id===s.value.doorId);if(u){const e=`${s.value.workdayStart.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})}-${s.value.workdayEnd.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})}`;u.openTime=e}G.value=!1,L.success("开放时间设置成功")},ee=async()=>{N.value&&await N.value.validate((u,e)=>{if(u){const _=`${d.value.startTime.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})}-${d.value.endTime.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})}`,r={id:g.value.length+1,name:d.value.name,location:d.value.location,type:d.value.type,openTime:_,allowedGroups:d.value.allowedGroups,deviceStatus:"online"};g.value.push(r),C.value=!1,L.success("新增门禁成功"),N.value.resetFields()}else console.log("error submit!",e)})};return(u,e)=>{const _=n("el-input"),r=n("el-option"),U=n("el-select"),O=n("el-icon"),m=n("el-button"),Q=n("el-button-group"),V=n("el-table-column"),D=n("el-tag"),le=n("el-table"),oe=n("el-card"),p=n("el-form-item"),M=n("el-radio"),ae=n("el-radio-group"),k=n("el-time-picker"),f=n("el-checkbox"),P=n("el-checkbox-group"),z=n("el-form"),A=n("el-dialog");return y(),S("div",re,[l(oe,null,{header:o(()=>[$("div",me,[$("div",se,[l(_,{modelValue:E.value,"onUpdate:modelValue":e[0]||(e[0]=a=>E.value=a),placeholder:"搜索门禁名称/位置","prefix-icon":"Search",clearable:"",class:"search-input"},null,8,["modelValue"]),l(U,{modelValue:F.value,"onUpdate:modelValue":e[1]||(e[1]=a=>F.value=a),placeholder:"门禁类型",clearable:""},{default:o(()=>[l(r,{label:"全部",value:""}),l(r,{label:"人脸识别",value:"人脸识别"}),l(r,{label:"刷卡门禁",value:"刷卡门禁"}),l(r,{label:"密码门禁",value:"密码门禁"})]),_:1},8,["modelValue"])]),l(Q,null,{default:o(()=>[l(m,{type:"success",onClick:e[2]||(e[2]=a=>C.value=!0)},{default:o(()=>[l(O,null,{default:o(()=>[l(R(de))]),_:1}),e[29]||(e[29]=t("新增门禁 "))]),_:1}),l(m,{type:"primary",onClick:e[3]||(e[3]=a=>w.value=!0)},{default:o(()=>[l(O,null,{default:o(()=>[l(R(ne))]),_:1}),e[30]||(e[30]=t("定时设置 "))]),_:1}),l(m,{type:"success",onClick:e[4]||(e[4]=a=>T.value=!0)},{default:o(()=>[l(O,null,{default:o(()=>[l(R(ie))]),_:1}),e[31]||(e[31]=t("权限设置 "))]),_:1})]),_:1})])]),default:o(()=>[l(le,{data:W.value,style:{width:"100%"},border:""},{default:o(()=>[l(V,{prop:"name",label:"门禁名称"}),l(V,{prop:"location",label:"位置"}),l(V,{prop:"type",label:"类型"},{default:o(({row:a})=>[l(D,null,{default:o(()=>[t(I(a.type),1)]),_:2},1024)]),_:1}),l(V,{prop:"openTime",label:"开放时间"}),l(V,{prop:"allowedGroups",label:"允许通行"},{default:o(({row:a})=>[(y(!0),S(B,null,q(a.allowedGroups,x=>(y(),H(D,{key:x,class:"group-tag",type:"info",size:"small"},{default:o(()=>[t(I(x),1)]),_:2},1024))),128))]),_:1}),l(V,{prop:"timing",label:"定时设置"},{default:o(({row:a})=>[a.timing?(y(),H(D,{key:0,type:"success"},{default:o(()=>[t(I(a.timing.type==="open"?"定时开启":"定时关闭")+" "+I(a.timing.time),1)]),_:2},1024)):(y(),H(D,{key:1,type:"info"},{default:o(()=>e[32]||(e[32]=[t("未设置")])),_:1}))]),_:1}),l(V,{label:"操作",width:"200"},{default:o(({row:a})=>[l(Q,null,{default:o(()=>[l(m,{type:"primary",link:"",onClick:x=>j(a)},{default:o(()=>e[33]||(e[33]=[t(" 定时 ")])),_:2},1032,["onClick"]),l(m,{type:"success",link:"",onClick:x=>J(a)},{default:o(()=>e[34]||(e[34]=[t(" 权限 ")])),_:2},1032,["onClick"]),l(m,{type:"warning",link:"",onClick:x=>c(a)},{default:o(()=>e[35]||(e[35]=[t(" 时间 ")])),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),_:1}),l(A,{modelValue:w.value,"onUpdate:modelValue":e[10]||(e[10]=a=>w.value=a),title:"定时设置",width:"400px"},{footer:o(()=>[l(m,{onClick:e[9]||(e[9]=a=>w.value=!1)},{default:o(()=>e[45]||(e[45]=[t("取消")])),_:1}),l(m,{type:"primary",onClick:K},{default:o(()=>e[46]||(e[46]=[t("确定")])),_:1})]),default:o(()=>[l(z,{model:i.value,"label-width":"80px"},{default:o(()=>[l(p,{label:"门禁"},{default:o(()=>[l(U,{modelValue:i.value.doorId,"onUpdate:modelValue":e[5]||(e[5]=a=>i.value.doorId=a),placeholder:"选择门禁"},{default:o(()=>[(y(!0),S(B,null,q(g.value,a=>(y(),H(r,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"类型"},{default:o(()=>[l(ae,{modelValue:i.value.type,"onUpdate:modelValue":e[6]||(e[6]=a=>i.value.type=a)},{default:o(()=>[l(M,{label:"open"},{default:o(()=>e[36]||(e[36]=[t("定时开启")])),_:1}),l(M,{label:"close"},{default:o(()=>e[37]||(e[37]=[t("定时关闭")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"时间"},{default:o(()=>[l(k,{modelValue:i.value.time,"onUpdate:modelValue":e[7]||(e[7]=a=>i.value.time=a),format:"HH:mm",placeholder:"选择时间"},null,8,["modelValue"])]),_:1}),l(p,{label:"重复"},{default:o(()=>[l(P,{modelValue:i.value.repeat,"onUpdate:modelValue":e[8]||(e[8]=a=>i.value.repeat=a)},{default:o(()=>[l(f,{label:"1"},{default:o(()=>e[38]||(e[38]=[t("周一")])),_:1}),l(f,{label:"2"},{default:o(()=>e[39]||(e[39]=[t("周二")])),_:1}),l(f,{label:"3"},{default:o(()=>e[40]||(e[40]=[t("周三")])),_:1}),l(f,{label:"4"},{default:o(()=>e[41]||(e[41]=[t("周四")])),_:1}),l(f,{label:"5"},{default:o(()=>e[42]||(e[42]=[t("周五")])),_:1}),l(f,{label:"6"},{default:o(()=>e[43]||(e[43]=[t("周六")])),_:1}),l(f,{label:"0"},{default:o(()=>e[44]||(e[44]=[t("周日")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(A,{modelValue:T.value,"onUpdate:modelValue":e[14]||(e[14]=a=>T.value=a),title:"权限设置",width:"500px"},{footer:o(()=>[l(m,{onClick:e[13]||(e[13]=a=>T.value=!1)},{default:o(()=>e[47]||(e[47]=[t("取消")])),_:1}),l(m,{type:"primary",onClick:Z},{default:o(()=>e[48]||(e[48]=[t("确定")])),_:1})]),default:o(()=>[l(z,{model:b.value,"label-width":"80px"},{default:o(()=>[l(p,{label:"门禁"},{default:o(()=>[l(U,{modelValue:b.value.doorId,"onUpdate:modelValue":e[11]||(e[11]=a=>b.value.doorId=a),placeholder:"选择门禁"},{default:o(()=>[(y(!0),S(B,null,q(g.value,a=>(y(),H(r,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"权限组"},{default:o(()=>[l(P,{modelValue:b.value.groups,"onUpdate:modelValue":e[12]||(e[12]=a=>b.value.groups=a)},{default:o(()=>[(y(),S(B,null,q(X,a=>l(f,{key:a.key,label:a.key},{default:o(()=>[t(I(a.label),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(A,{modelValue:G.value,"onUpdate:modelValue":e[20]||(e[20]=a=>G.value=a),title:"开放时间设置",width:"400px"},{footer:o(()=>[l(m,{onClick:e[19]||(e[19]=a=>G.value=!1)},{default:o(()=>e[51]||(e[51]=[t("取消")])),_:1}),l(m,{type:"primary",onClick:h},{default:o(()=>e[52]||(e[52]=[t("确定")])),_:1})]),default:o(()=>[l(z,{model:s.value,"label-width":"100px"},{default:o(()=>[l(p,{label:"工作日"},{default:o(()=>[l(k,{modelValue:s.value.workdayStart,"onUpdate:modelValue":e[15]||(e[15]=a=>s.value.workdayStart=a),format:"HH:mm",placeholder:"开始时间"},null,8,["modelValue"]),e[49]||(e[49]=$("span",{class:"time-separator"},"至",-1)),l(k,{modelValue:s.value.workdayEnd,"onUpdate:modelValue":e[16]||(e[16]=a=>s.value.workdayEnd=a),format:"HH:mm",placeholder:"结束时间"},null,8,["modelValue"])]),_:1}),l(p,{label:"节假日"},{default:o(()=>[l(k,{modelValue:s.value.holidayStart,"onUpdate:modelValue":e[17]||(e[17]=a=>s.value.holidayStart=a),format:"HH:mm",placeholder:"开始时间"},null,8,["modelValue"]),e[50]||(e[50]=$("span",{class:"time-separator"},"至",-1)),l(k,{modelValue:s.value.holidayEnd,"onUpdate:modelValue":e[18]||(e[18]=a=>s.value.holidayEnd=a),format:"HH:mm",placeholder:"结束时间"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(A,{modelValue:C.value,"onUpdate:modelValue":e[28]||(e[28]=a=>C.value=a),title:"新增门禁",width:"500px"},{footer:o(()=>[l(m,{onClick:e[27]||(e[27]=a=>C.value=!1)},{default:o(()=>e[58]||(e[58]=[t("取消")])),_:1}),l(m,{type:"primary",onClick:ee},{default:o(()=>e[59]||(e[59]=[t("确定")])),_:1})]),default:o(()=>[l(z,{model:d.value,rules:Y,ref_key:"addFormRef",ref:N,"label-width":"100px"},{default:o(()=>[l(p,{label:"门禁名称",prop:"name"},{default:o(()=>[l(_,{modelValue:d.value.name,"onUpdate:modelValue":e[21]||(e[21]=a=>d.value.name=a),placeholder:"请输入门禁名称"},null,8,["modelValue"])]),_:1}),l(p,{label:"所在位置",prop:"location"},{default:o(()=>[l(U,{modelValue:d.value.location,"onUpdate:modelValue":e[22]||(e[22]=a=>d.value.location=a),placeholder:"选择位置"},{default:o(()=>[l(r,{label:"教学区",value:"教学区"}),l(r,{label:"实验区",value:"实验区"}),l(r,{label:"生活区",value:"生活区"}),l(r,{label:"运动区",value:"运动区"}),l(r,{label:"办公区",value:"办公区"})]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"门禁类型",prop:"type"},{default:o(()=>[l(U,{modelValue:d.value.type,"onUpdate:modelValue":e[23]||(e[23]=a=>d.value.type=a),placeholder:"选择类型"},{default:o(()=>[l(r,{label:"人脸识别",value:"人脸识别"}),l(r,{label:"刷卡门禁",value:"刷卡门禁"}),l(r,{label:"密码门禁",value:"密码门禁"})]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"开放时间",prop:"openTime"},{default:o(()=>[l(k,{modelValue:d.value.startTime,"onUpdate:modelValue":e[24]||(e[24]=a=>d.value.startTime=a),format:"HH:mm",placeholder:"开始时间"},null,8,["modelValue"]),e[53]||(e[53]=$("span",{class:"time-separator"},"至",-1)),l(k,{modelValue:d.value.endTime,"onUpdate:modelValue":e[25]||(e[25]=a=>d.value.endTime=a),format:"HH:mm",placeholder:"结束时间"},null,8,["modelValue"])]),_:1}),l(p,{label:"允许通行",prop:"allowedGroups"},{default:o(()=>[l(P,{modelValue:d.value.allowedGroups,"onUpdate:modelValue":e[26]||(e[26]=a=>d.value.allowedGroups=a)},{default:o(()=>[l(f,{label:"教师"},{default:o(()=>e[54]||(e[54]=[t("教师")])),_:1}),l(f,{label:"学生"},{default:o(()=>e[55]||(e[55]=[t("学生")])),_:1}),l(f,{label:"工作人员"},{default:o(()=>e[56]||(e[56]=[t("工作人员")])),_:1}),l(f,{label:"访客"},{default:o(()=>e[57]||(e[57]=[t("访客")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},ye=te(pe,[["__scopeId","data-v-7bf33571"]]);export{ye as default};
